\newcommand{\core}{AES-128 HPC2 }
\newcommand{\clk}{\ensuremath{\texttt{clk}}}
\newcommand{\rst}{\ensuremath{\texttt{syn\_rst}}}
\newcommand{\svrsInValid}{\ensuremath{\texttt{in\_valid}}}
\newcommand{\svrsInReady}{\ensuremath{\texttt{in\_ready}}}
\newcommand{\svrsPlaintext}{\ensuremath{\texttt{in\_shares\_plaintext}}}
\newcommand{\svrsKey}{\ensuremath{\texttt{in\_shares\_key}}}
\newcommand{\svrsCiphertext}{\ensuremath{\texttt{out\_shares\_ciphertext}}}
\newcommand{\svrsOutValid}{\ensuremath{\texttt{out\_valid}}}
\newcommand{\svrsOutReady}{\ensuremath{\texttt{out\_ready}}}
\newcommand{\svrsSeed}{\ensuremath{\texttt{in\_seed}}}
\newcommand{\svrsSeedValid}{\ensuremath{\texttt{in\_seed\_valid}}}
\newcommand{\svrsSeedReady}{\ensuremath{\texttt{in\_seed\_ready}}}

\newcommand{\topName}{\ensuremath{\texttt{aes\_enc128\_32bits\_hpc2}}}
\newcommand{\topModAES}{\ensuremath{\texttt{MSKaes\_32bits\_core}}}
\newcommand{\topModPRNG}{\ensuremath{\texttt{prng\_top}}}
\newcommand{\topModReseedCtrl}{\ensuremath{\texttt{reseed\_controller}}}
\newcommand{\topModsvrsCtrl}{\ensuremath{\texttt{reseed\_controller}}}
\newcommand{\SB}{\ensuremath{\texttt{SubBytes}}}
\newcommand{\SR}{\ensuremath{\texttt{ShiftRows}}}
\newcommand{\MC}{\ensuremath{\texttt{MixColumns}}}
\newcommand{\AK}{\ensuremath{\texttt{AddRoundKey}}}

% Ports of AES core
\newcommand{\portAESInValid}{\ensuremath{\texttt{valid\_in}}}
\newcommand{\portAESInReady}{\ensuremath{\texttt{in\_ready}}}
\newcommand{\portAESInPlaintext}{\ensuremath{\texttt{sh\_plaintext}}}
\newcommand{\portAESInKey}{\ensuremath{\texttt{sh\_key}}}
\newcommand{\portAESbusy}{\ensuremath{\texttt{busy}}}
\newcommand{\portAESOutValid}{\ensuremath{\texttt{cipher\_valid}}}
\newcommand{\portAESOutReady}{\ensuremath{\texttt{out\_ready}}}
\newcommand{\portAESOutCipher}{\ensuremath{\texttt{sh\_ciphertext}}}
\newcommand{\portAESRnd}{\ensuremath{\texttt{rnd}}}
\newcommand{\portAESRndReady}{\ensuremath{\texttt{in\_rnd\_ready}}}

% Ports of PRNG 
\newcommand{\portPrngSeed}{\ensuremath{\texttt{in\_seed}}}
\newcommand{\portPrngStartReseed}{\ensuremath{\texttt{start\_reseed}}}
\newcommand{\portPrngOutReady}{\ensuremath{\texttt{out\_ready}}}
\newcommand{\portPrngOutValid}{\ensuremath{\texttt{out\_valid}}}
\newcommand{\portPrngOutRnd}{\ensuremath{\texttt{out\_rnd}}}
\newcommand{\portPrngBusy}{\ensuremath{\texttt{busy}}}

\newcommand{\triviumKey}{\ensuremath{\texttt{key}[79:0]}}
\newcommand{\triviumIV}{\ensuremath{\texttt{IV}[79:0]}}
\newcommand{\triviumInState}{\ensuremath{1 | 1 | 1 | 0^{112} | \triviumIV | 0^{13} | \triviumKey}}
\newcommand{\triviumOut}{\ensuremath{\texttt{stream}}}

% AES submodule
\newcommand{\modAESdpState}{\ensuremath{\texttt{MSKaes\_32bits\_state\_datapath}}}
\newcommand{\modAESdpKey}{\ensuremath{\texttt{MSKaes\_32bits\_key\_datapath}}}
\newcommand{\modAESsbox}{\ensuremath{\texttt{MSKSbox}}}

\newcommand{\AESsboxIn}{\ensuremath{\texttt{bytes\_to\_SB}}}
\newcommand{\AESsboxOut}{\ensuremath{\texttt{bytes\_from\_SB}}}
\newcommand{\AESsboxRnd}{\ensuremath{\texttt{rnd}}}
\newcommand{\AESsboxValidIn}{\ensuremath{\texttt{sbox\_valid\_in}}}
\newcommand{\AESsboxValidOut}{\ensuremath{\texttt{sbox\_valid\_out}}}
\newcommand{\AESsboxFeedKey}{\ensuremath{\texttt{feed\_sb\_key}}}
\newcommand{\AESFetchIn}{\ensuremath{\texttt{tap\_top\_input}}}

\newcommand{\AESdpStatePlaintext}{\ensuremath{\texttt{sh\_plaintext}}}
\newcommand{\AESdpStateFromSB}{\ensuremath{\texttt{sh\_4bytes\_from\_SB}}}
\newcommand{\AESdpStateFromKey}{\ensuremath{\texttt{sh\_4bytes\_from\_key}}}
\newcommand{\AESdpStateToSB}{\ensuremath{\texttt{sh\_4bytes\_to\_SB}}}
\newcommand{\AESdpStateCiphertext}{\ensuremath{\texttt{sh\_ciphertext}}}

\newcommand{\AESdpKeyKey}{\ensuremath{\texttt{sh\_key}}}
\newcommand{\AESdpKeyToSB}{\ensuremath{\texttt{sh\_4bytes\_rot\_to\_SB}}}
\newcommand{\AESdpKeyFromSB}{\ensuremath{\texttt{sh\_4bytes\_rot\_from\_SB}}}
\newcommand{\AESdpKeyToAK}{\ensuremath{\texttt{sh\_4bytes\_to\_AK}}}


% dpState internal
\newcommand{\dpStateModMC}{\ensuremath{\texttt{MC\_unit}}}
\newcommand{\dpStateByteToMC}{\ensuremath{\texttt{a}}}
\newcommand{\dpStateByteFromMC}{\ensuremath{\texttt{b}}}
\newcommand{\dpStateCtrlRouteMC}{\ensuremath{\texttt{route\_MC}}}
\newcommand{\dpStateCtrlRouteLoop}{\ensuremath{\texttt{loop}}}
\newcommand{\dpStateCtrlRouteIn}{\ensuremath{\texttt{init}}}
\newcommand{\dpStateCtrlEnable}{\ensuremath{\texttt{state\_enable}}}

% dpKey internal
\newcommand{\dpKeyCtrlInit}{\ensuremath{\texttt{init}}}
\newcommand{\dpKeyCtrlLoop}{\ensuremath{\texttt{loop}}}
\newcommand{\dpKeyCtrlRouteScan}{\ensuremath{\texttt{\dpKeyCtrlInit||\dpKeyCtrlLoop}}}
\newcommand{\dpKeyCtrlRouteInit}{\dpKeyCtrlInit}
\newcommand{\dpKeyCtrlRouteLoop}{\dpKeyCtrlLoop}
\newcommand{\dpKeyCtrlRouteFromSB}{\ensuremath{\texttt{from\_SB}}}
\newcommand{\dpKeyCtrlEnable}{\ensuremath{\texttt{KH\_enable}}}

%% Time only
\newcommand{\timeCnrRound}{\ensuremath{\texttt{cnt\_round}}}
\newcommand{\timeCnrCycle}{\ensuremath{\texttt{cnt\_fsm}}}
\newcommand{\timeCnrExecCycles}{\ensuremath{\texttt{cnt\_cycles}}}

%%% Pseudo code 
\newcommand{\pP}[1]{\ensuremath{\texttt{P}_{#1}}}
\newcommand{\pK}[1]{\ensuremath{\texttt{K}_{#1}}}
\newcommand{\pCt}[1]{\ensuremath{\texttt{C}_{#1}}}
\newcommand{\pS}[2]{\ensuremath{\texttt{S}_{#1}^{#2}}}
\newcommand{\pRK}[2]{\ensuremath{\texttt{RK}_{#1}^{#2}}}

\newcommand{\pSB}[2]{\ensuremath{\texttt{SB}_{#1}^{#2}}}
\newcommand{\pSR}[2]{\ensuremath{\texttt{SR}_{#1}^{#2}}}
\newcommand{\pMC}[2]{\ensuremath{\texttt{MC}_{#1}^{#2}}}
\newcommand{\pAK}[2]{\ensuremath{\texttt{AK}_{#1}^{#2}}}

\newcommand{\pR}[2]{\ensuremath{\texttt{R}_{#1}^{#2}}}
\newcommand{\pRSB}[2]{\ensuremath{\texttt{RSB}_{#1}^{#2}}}
\newcommand{\SW}[1]{\ensuremath{\texttt{SubWord}(#1)}}

\newcommand{\RCON}[1]{\ensuremath{\texttt{RCON}^{#1}}}


%% Pipe data routing font Size
\newcommand{\pipeFS}{\scriptsize}
\newcommand{\cDP}[1]{2D{\pipeFS #1}}
\newcommand{\NcDP}[2]{#2{2D}{\pipeFS #1}}

%% Pipeline dp Key
\newcommand{\dpKeyDFF}[1]{\ensuremath{\texttt{sh\_m\_key[#1]}}}

\newcommand{\timeStartdpKey}[1]{D{}\cDP{\pRK{#1}{i-1}}}
\newcommand{\timeFivedpKey}[4]{\NcDP{\pRK{#1}{i-1}}{1}\cDP{\pRK{#2}{i-1}}\cDP{\pRK{#3}{i-1}}\cDP{\pRK{#4}{i-1}}}
\newcommand{\timePartdpKey}[4]{\cDP{\pRK{#2}{i-1}}\cDP{\pRK{#3}{i-1}}\cDP{\pRK{#4}{i-1}}}
\newcommand{\timeStopdpKey}[2]{\NcDP{\pRK{#1}{i}}{1}\cDP{\pRK{#2}{i}}}

\newcommand{\timeMidIdpKey}[4]{\NcDP{\pRK{#1}{i}}{1}\cDP{\pRK{#2}{i}}\cDP{\pRK{#3}{i}}\cDP{\pRK{#4}{i}}}
\newcommand{\timeMidIIdpKey}[4]{\NcDP{\pRK{#1}{i-1}}{1}\cDP{\pRK{#2}{i-1}}\cDP{\pRK{#3}{i-1}}\cDP{\pRK{#4}{i}}}
\newcommand{\timeMidIIIdpKey}[4]{\NcDP{\pRK{#1}{i-1}}{1}\cDP{\pRK{#2}{i-1}}\cDP{\pRK{#3}{i}}\cDP{\pRK{#4}{i}}}
\newcommand{\timeMidIIIIdpKey}[4]{\NcDP{\pRK{#1}{i-1}}{1}\cDP{\pRK{#2}{i}}\cDP{\pRK{#3}{i}}\cDP{\pRK{#4}{i}}}

\newcommand{\timeLinedpKeyI}[4]{\timeStartdpKey{#4}\timeFivedpKey{#1}{#2}{#3}{#4}\timeMidIdpKey{#1}{#2}{#3}{#4}\timeStopdpKey{#1}{#2}}
\newcommand{\timeLinedpKeyII}[4]{\timeStartdpKey{#4}\timeFivedpKey{#1}{#2}{#3}{#4}\timeMidIIdpKey{#1}{#2}{#3}{#4}\timeStopdpKey{#1}{#2}}
\newcommand{\timeLinedpKeyIII}[4]{\timeStartdpKey{#4}\timeFivedpKey{#1}{#2}{#3}{#4}\timeMidIIIdpKey{#1}{#2}{#3}{#4}\timeStopdpKey{#1}{#2}}
\newcommand{\timeLinedpKeyIIII}[4]{\timeStartdpKey{#4}\timeFivedpKey{#1}{#2}{#3}{#4}\timeMidIIIIdpKey{#1}{#2}{#3}{#4}\timeStopdpKey{#1}{#2}}

%% Pipeline dp State
\newcommand{\dpStateDFF}[1]{\ensuremath{\texttt{sh\_reg\_out[#1]}}}

% Start
\newcommand{\timeStInterndpStateXII}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pS{#2}{i}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateXIII}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateXIV}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateXV}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pS{#1}{i}}}

\newcommand{\timeStInterndpStateXI}[4]{D{}\cDP{\pMC{3}{i-1}}\cDP{\pMC{7}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pS{#2}{i}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateX}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateIX}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateVIII}[4]{D{}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}

\newcommand{\timeStInterndpStateIV}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateV}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateVI}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pS{#2}{i}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateVII}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}

\newcommand{\timeStInterndpStateIII}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pS{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateII}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pS{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateI}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pS{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pS{#2}{i}}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pS{#1}{i}}}
\newcommand{\timeStInterndpStateZ}[4]{D{}\cDP{\pS{#3}{i-1}}\cDP{\pS{#4}{i-1}}\cDP{\pMC{#1}{i-1}}\cDP{\pMC{#2}{i-1}}\cDP{\pMC{#3}{i-1}}\cDP{\pMC{#4}{i-1}}\cDP{\pS{#1}{i}}}

% End 
\newcommand{\timeEndInterndpStateXII}[4]{\cDP{\pMC{#2}{i}}\cDP{\pMC{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pS{#2}{i+1}}}
\newcommand{\timeEndInterndpStateXIII}[4]{\cDP{\pMC{#2}{i}}\cDP{\pMC{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pMC{#2}{i}}}

\newcommand{\timeEndInterndpStateXI}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pMC{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pS{#2}{i+1}}}
\newcommand{\timeEndInterndpStateX}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pMC{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pMC{#2}{i}}}

\newcommand{\timeEndInterndpStateVII}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pS{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pMC{#2}{i}}}
\newcommand{\timeEndInterndpStateVI}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pS{#3}{i}}\cDP{\pMC{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pS{#2}{i+1}}}

\newcommand{\timeEndInterndpStateIII}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pMC{#2}{i}}}
\newcommand{\timeEndInterndpStateI}[4]{\NcDP{\pS{#2}{i}}{1}\cDP{\pS{#3}{i}}\cDP{\pS{#4}{i}}\cDP{\pMC{#1}{i}}\cDP{\pS{#2}{i+1}}}

% Full line
\newcommand{\timeLinedpStateXII}[4]{\timeStInterndpStateXII{#1}{#2}{#3}{#4}\timeEndInterndpStateXII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateXIII}[4]{\timeStInterndpStateXIII{#1}{#2}{#3}{#4}\timeEndInterndpStateXIII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateXIV}[4]{\timeStInterndpStateXIV{#1}{#2}{#3}{#4}\timeEndInterndpStateXIII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateXV}[4]{\timeStInterndpStateXV{#1}{#2}{#3}{#4}\timeEndInterndpStateXIII{#1}{#2}{#3}{#4}}

\newcommand{\timeLinedpStateVIII}[4]{\timeStInterndpStateVIII{#1}{#2}{#3}{#4}\timeEndInterndpStateX{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateIX}[4]{\timeStInterndpStateIX{#1}{#2}{#3}{#4}\timeEndInterndpStateX{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateX}[4]{\timeStInterndpStateX{#1}{#2}{#3}{#4}\timeEndInterndpStateX{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateXI}[4]{\timeStInterndpStateXI{#1}{#2}{#3}{#4}\timeEndInterndpStateXI{#1}{#2}{#3}{#4}}

\newcommand{\timeLinedpStateIV}[4]{\timeStInterndpStateIV{#1}{#2}{#3}{#4}\timeEndInterndpStateVII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateV}[4]{\timeStInterndpStateV{#1}{#2}{#3}{#4}\timeEndInterndpStateVII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateVI}[4]{\timeStInterndpStateVI{#1}{#2}{#3}{#4}\timeEndInterndpStateVI{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateVII}[4]{\timeStInterndpStateVII{#1}{#2}{#3}{#4}\timeEndInterndpStateVII{#1}{#2}{#3}{#4}}

\newcommand{\timeLinedpStateZ}[4]{\timeStInterndpStateZ{#1}{#2}{#3}{#4}\timeEndInterndpStateIII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateI}[4]{\timeStInterndpStateI{#1}{#2}{#3}{#4}\timeEndInterndpStateI{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateII}[4]{\timeStInterndpStateII{#1}{#2}{#3}{#4}\timeEndInterndpStateIII{#1}{#2}{#3}{#4}}
\newcommand{\timeLinedpStateIII}[4]{\timeStInterndpStateIII{#1}{#2}{#3}{#4}\timeEndInterndpStateIII{#1}{#2}{#3}{#4}}

%% PRNG section
\newcommand{\NRNDBITS}{\ensuremath{\texttt{NRNDBITS}}}
\newcommand{\MULHPCRND}{\ensuremath{\texttt{MUL\_HPC2\_RND}}}
\newcommand{\NTRIVIUMS}{\ensuremath{\texttt{NTRIVIUMS}}}
\newcommand{\UNROLL}{\ensuremath{\texttt{UNROLL}}}
\newcommand{\MAXUNROLL}{\ensuremath{\texttt{PRNG\_MAX\_UNROLL}}}

